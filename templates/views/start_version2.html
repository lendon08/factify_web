<!-- templates/start_page.html -->
{% extends "_base2.html" %}

{% load static %}
{% block content %}
     <!-- Initial -->
    {% if todisplay == 1 %}
    
      <div class="flex flex-col pl-4 text-left text-gray-600 justify-between w-3/12">
        <div>
          <div class="pt-4 mb-4 text-gray-800">
            <h3 class="text-lg"><strong>Let’s get started.</strong></h3>
          </div>    
          <ul class="space-y-4 text-xs">
            <li><span class="text-gray-800">Step 1:</span> Type or paste the news article.</li>
            <li><span class="text-gray-800">Step 2:</span> Click the <em>‘Detect’</em> button to analyze the article.</li>
            <li><span class="text-gray-800">Step 3:</span> Wait for the results</li>
          </ul>
        </div>
        <div class="flex w-full h-1/4 items-end text-xs">
          <div class="flex w-full mb-4 mx-4 justify-items-stretch space-x-4">
            <button type="reset" onClick="document.getElementById('editor').innerHTML =''" class="w-full px-5 py-2.5 text-blue-600 bg-blue-50 rounded-lg transition duration-75 hover:bg-blue-100">
                Clear
            </button>
            <button type="submit" class="w-full px-5 py-2.5 text-white bg-blue-700 rounded-lg transition duration-75 hover:bg-blue-600 hover:text-gray-700">
                Detect
            </button>
            
          </div>
        </div>
      </div>
    {% elif todisplay == 2 %}
      <div class="flex flex-col pl-4 text-left text-gray-600 justify-between w-3/12">
        <div class="flex flex-col w-full h-full justify-center items-center space-y-8">
          <div role="status">
              <svg aria-hidden="true" class="inline w-52 h-52 text-gray-200 animate-pulse dark:text-gray-600 " viewBox="0 0 400 400" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle r="50" cx="200" cy="200" stroke="#004CC6" stroke-width="20" opacity="0.5"/>
                <circle r="90" cx="200" cy="200" stroke="#004CC6" stroke-width="20" opacity="0.75"/>
                <circle r="130" cx="200" cy="200" stroke="#004CC6" stroke-width="20" />
              </svg>
              <span class="sr-only">Loading...</span>
          </div>
          <div>Analyzing Text</div>  
        </div>
        
        <div class="flex w-full h-1/4 items-end ">
          <div class="w-full mb-4 mx-4 justify-items-stretch">
            <button type="reset" onClick="document.getElementById('editor').innerHTML =''" class="w-full px-5 py-2.5 text-sm font-medium  text-blue-600 bg-blue-50 rounded-lg transition duration-75 hover:bg-blue-100">
              Clear
            </button>
          </div>
        </div>
      </div>
      
    {% else %}
    <div class="flex flex-col bg-gray-50 text-gray-800 w-3/12 items-center min-h-0 max-h-screen min-w-0 max-w-screen space-y-4 px-4 pt-2">
      <div class="pl-2 mx-auto min-w-0 max-w-full" id="fake"></div>
      {% if todisplay == 3 %}
      <h3 class="text-green-600">REAL</h3>
      {% else %}
      <h3 class="text-red-600">FAKE</h3>
      {% endif %}
      <div class="w-full ml-2 overflow-x-auto ">
        <table class="w-full text-xs text-left  text-gray-500 bg-gray-50 ">
            {% for a,b,c in estimators %}
                <tr class="space-x-2">
                    <th scope="row" class="py-2 font-medium dark:text-white">
                      {{ a }}
                    </th>
                    
                    <td class="py-2 font-medium">
                      {{ b }}
                    </td>
                    <td class="py-2 font-medium">
                      {{ c }}
                    </td>
                    
                </tr>
            {% endfor %}
        </table>
      </div>
      <div class="flex w-full h-10 items-end text-xs">
        <div class="flex w-full mb-4 mx-4 justify-items-stretch space-x-4">
          <button type="reset" onClick="document.getElementById('editor').innerHTML =''" class="w-full px-5 py-2.5 text-blue-600 bg-blue-50 rounded-lg transition duration-75 hover:bg-blue-100">
              Clear
          </button>
          <button type="submit" class="w-full px-5 py-2.5 text-white bg-blue-700 rounded-lg transition duration-75 hover:bg-blue-600 hover:text-gray-700">
              Detect
          </button>
        </div>
      </div>
    </div>
    {% endif %}
    <!-- Analyze (Display while waiting for the model to response.) -->
    <!--  -->

   

    <!-- Real (Display when the model returns a value that is less than 50%)--->
    

    <!-- Fake  (Display when the model returns a value that is more than 50%)-->


    <!-- Neutral (Display when the model returns a value that is 50%) -->
    
  
{% endblock content %}


{% block scripts %}
<script>
  const total = 100;
  // This is not safe if deployed in the internet. CAUTION
  let percent = {{ percentage }};
  let dispLabel = "";
  let color =[];
  let dat = [percent, total-percent];
  let label = [ "Fake", "Real"];
  let toreturn = percent;
  let toDisp = {{ todisplay }} ;

  if(toDisp == 4){    
    color = ["#FF5555", "#CFCFCF"];
    dispLabel = "Fraudulent";
  }
  else{
    color = ["#019A5A", "#CFCFCF"];
    label = [ "Real", "Fake" ]
    dat = [percent ,total-percent ]
    // toreturn =  total-percent;
    dispLabel = "Legitimate";
  }
const getChartOptions = () => {
    return {
      fontSize: '14px',
      series: dat,
      colors: color,
      chart: {
        width: '75%',
        type: "donut",
        events: {
          mounted: (chart) => {
            chart.windowResizeHandler();
          }
        }
      },
      stroke: {
        colors: ["transparent"],
        lineCap: "",
      },
      plotOptions: {
        pie: {
          donut: {
            labels: {
              show: true,
              name: {
                show: true,
                fontFamily: "Inter, sans-serif",
                offsetY: 20,
              },
              total: {
                showAlways: true,
                show: true,
                label: dispLabel,
                fontFamily: "Inter, sans-serif",
                fontSize: '10',
                formatter: function (w) {
                  return toreturn + '%'
                },
              },
              value: {
                showAlways: true,
                show: true,
                fontFamily: "Inter, sans-serif",
                offsetY: -20,
                formatter: function (val) {
                  return val + "%"
                },
              },
            },
            size: "90%",
          },
        },
      },
      grid: {
        padding: {
          top: -2,
        },
      },
      labels: label,
      dataLabels: {
        enabled: false,
      },
      legend: {
        width: '75%',
        height: '750%',
        position: "bottom",
        fontFamily: "Inter, sans-serif",
      },
      yaxis: {
        labels: {
          formatter: function (value) {
            return value + "%"
          },
        },
      },
      xaxis: {
        labels: {
          formatter: function (value) {
            return value  + "%"
          },
        },
        axisTicks: {
          show: false,
        },
        axisBorder: {
          show: false,
        },
      },
    }
  }

 
    var chart = new ApexCharts(document.getElementById("fake"), getChartOptions());
    chart.render();
    //var neutral = new ApexCharts(document.getElementById("neutral"), getChartOptions());
    //neutral.render();
    //var legit = new ApexCharts(document.getElementById("legit"), getChartOptions());
    //legit.render();
    
    
  </script>
{% endblock scripts %}